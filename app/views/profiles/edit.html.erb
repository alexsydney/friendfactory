<% stylesheet 'profiles' %>
<div class='profile wave grid_12'>
	<div id="tabs">
		<ul>		  
		   <li><a href="#home" class='current'>Home</a></li>
		   <li><a href="#avatar">Avatar</a></li>
		   <li><a href="#about">About Me</a></li>
		   <li><a href="#photos">Photos</a></li>
		   <li><a href="#buddies">Buddies</a></li>
		   <% if false %><li class='ajax'><a href="#links">Links</a></li><% end %>
		</ul>
		
		<div id='home' class='tab_content grid_16 alpha omega'>
      <h1><%= current_user.first_name %>&#146;s Wave</h1>
      <% if current_user.profile.postings.empty? %>	
      	<h3>Do something with your profile to meet friends!</h3>
      <% else %>
        <%= render :partial => 'wave', :object => current_user.profile %>
      <% end %>
		</div>
					
		<div id='avatar' class='tab_content grid_16 alpha omega'>	
			<h1><%= current_user.first_name %>&#146;s&nbsp;Avatar</h1>
			<% form_for Posting::Avatar::new,
						:url  => avatars_path(:format => :js),
						:html => { :multipart => true, :target => 'upload_frame' } do |f| %>
				<div id='avatar_upload_error' class='hidden'></div>
				<div id='avatar_upload_well' class='append-bottom clearfix'>
					<%= render :partial => 'avatars/edit', :object => current_user.profile.avatar %>
				</div>
				<div class='button_bar'><%= f.file_field :image %><%= f.submit 'Upload', :id => 'avatar_upload_submit' %><%= spinner %></div>
			<% end %>
		</div>
		
		<div id="about" class='tab_content grid_16 alpha omega'>
			<h1>About Me</h1>
			<%= render :partial => 'user_info/edit' %>
		</div>

		<div id="photos" class='tab_content grid_16 alpha omega'>
			<h1>Photos of <%= current_user.first_name -%></h1>
			<% form_for Posting::Photo::new,
						:url  => photos_path(:format => :js),
						:html => { :multipart => true, :target => 'upload_frame' } do |f| %>
				<div id='photo_upload_error' class='hidden'></div>
				<div id='photo_upload_well' class='append-bottom clearfix'>
					<%= render :partial => 'photos/edit', :collection => current_user.profile.photos %>
				</div>
				<div class='button_bar'><%= f.file_field :image %><%= f.submit 'Upload', :id => 'photo_upload_submit' %><%= spinner %></div>
			<% end %>
		</div>

		<div id="buddies" class='tab_content grid_16 alpha omega'>
			<h1><%= current_user.first_name -%>&#146;s&nbsp;Buddies</h1>
		</div>

		<div id="links" class='tab_content grid_16 alpha omega'>
			<h1>Links</h1>
		</div>		
	</div>
	<iframe id='upload_frame' name="upload_frame" width='1' height='1' style='border:0px' src='about:blank'></iframe>
</div>

<% javascript_tag do %>
	jQuery(document).ready(function($){		
		// $('.button_bar button:submit').button({ icons: { primary: 'ui-icon-check' }});		
		$('#tabs li:eq(0)').button({ text: false, icons: { primary: 'ui-icon-home' }});			
		$('#tabs li:eq(1)').button({ icons: { primary: 'ui-icon-person' }})	
		$('#tabs li:eq(2)').button({ icons: { primary: 'ui-icon-script' }});	
		$('#tabs li:eq(3)').button({ icons: { primary: 'ui-icon-image' }});
		$('#tabs li:eq(4)').button({ icons: { primary: 'ui-icon-heart' }});
		$('#tabs li:eq(5)').button({ icons: { primary: 'ui-icon-link' }});
		
		$('#tabs div.tab_content:first')
			.show()
			.siblings('div.tab_content')
			.hide();
		
		$('#tabs ul li').click(function(){
			if (!$(this).hasClass('current')) {
				$(this)
				  .addClass('current')
				  .siblings('li.current')
				  .removeClass('current');
				$($(this)
				  .find('a')
				    .attr('href'))
				    .show()
				    .siblings('div.tab_content')
				    .hide();
				this.blur();
				return false;
			}
		});
		
		$('#tabs ul li:first-child').click(function(){
		  $('#home').load('<%= home_profile_path(current_user.profile) %>');
		});
		
		// jQuery('#upload_submit').click(function(){
	  //   jQuery('#spinner').show();
		// });
		
		// $('#tabs ul li:first a').click();
	});	
<% end %>
