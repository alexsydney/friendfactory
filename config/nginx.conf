user mrcap users; 

worker_processes  4;

pid /var/run/nginx.pid;

error_log  logs/error.log;
# error_log  logs/error.log  notice;
# error_log  logs/error.log  info;

events {
    worker_connections  1024;
}


http {
    include mime.types;
    default_type application/octet-stream;

    log_format main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log logs/access.log  main;

    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout  65;

    open_file_cache max=1000 inactive=1h;

    gzip on;
    gzip_http_version 1.0;
    gzip_comp_level 2;
    gzip_proxied any;
    gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript;

    passenger_root /home/mrcap/.rvm/gems/ruby-1.9.2-p0/gems/passenger-3.0.0;
    passenger_ruby /home/mrcap/.rvm/wrappers/ruby-1.9.2-p0/ruby;

    server {
    	listen		80;
    	server_name	www.friskyhands.com; 
    	rewrite ^	$scheme://friskyhands.com$request_uri permanent;
    }

    server {
    	listen		80;
    	server_name	www.positivelyfrisky.com;
    	rewrite ^	$scheme://positivelyfrisky.com$request_uri permanent;
    }

    server {
    	listen		80;
    	server_name	www.friskysoldiers.com;
    	rewrite ^	$scheme://friskysoldiers.com$request_uri permanent;
    }

    server {
    	listen		80;
    	server_name	.friskysoldier.com;
    	rewrite ^	$scheme://friskysoldiers.com$request_uri permanent;
    }

    server {
    	listen		80;
    	server_name	staging.dizmdays.com;
    	rewrite ^	$scheme://staging.dizmdays.com$request_uri permanent;
    }


    server {
    	listen		80;
    	server_name	.friskyfactory.com;
    	root		/home/mrcap/friskyfactory/production/current/public;
    	access_log	logs/friskyfactory.access.log main;
    	client_max_body_size 10m;
	    # expires 24h;
    }

    server {
    	listen		80;
    	server_name	.friskyhands.com;
    	root		/home/mrcap/friskyfactory/production/current/public;
    	access_log	logs/friskyfactory.access.log main;
    	client_max_body_size 10m;
	    # expires 24h;

        passenger_enabled on;
        rails_env production;

    	location ^~ /(javascripts|stylesheets) {
            expires +24h;
            add_header Cache-Control +24h;
            add_header Cache-control public;
    	}

    	location ^~ /system/images {
            expires +365d;
            add_header Cache-Control +365d;
            add_header Cache-control public;
    	}

    	location ~* ^.+\.(jpg|jpeg|gif)$ {
            expires +24h;
            add_header Cache-Control +24h;
            add_header Cache-control public;
    	}

        # error_page 404 /404.html;
        # redirect server error pages to the static page /50x.html
        #
        # error_page 500 502 503 504  /50x.html;
        # location = /50x.html {
        #   root html;
        # }

        if (-f $document_root/system/maintenance.html) {
            rewrite ^(.*)$ /system/maintenance.html last;
            break;
        }
    }


    server {
    	listen		80;
    	server_name	.positivelyfrisky.com;
    	root		/home/mrcap/friskyfactory/production/current/public;
    	access_log	logs/friskyfactory.access.log main;
    	client_max_body_size 10m;
	    # expires 24h;

        passenger_enabled on;
        rails_env production;
    }


    server {
        listen 80;
        server_name	.friskysoldiers.com;
        root /home/mrcap/friskyfactory/production/current/public;
        access_log	logs/friskyfactory.access.log main;
        client_max_body_size 10m;
        # expires 24h;
        passenger_enabled on;
        rails_env production;
    }


    server {
    	listen		80;
    	server_name	staging.friskyhands.com;
    	root		/home/mrcap/friskyfactory/staging/current/public;
    	access_log	logs/friskyfactory.staging.access.log main;
    	client_max_body_size 10m;
    	# expires 24h;

        passenger_enabled on;
        rails_env staging;

	    location ^~ /(javascripts|stylesheets) {
          expires +24h; 
          add_header Cache-Control +24h;
          add_header Cache-control public;
        }

        location ^~ /system/images {
          expires +365d;
          add_header Cache-Control +365d;
          add_header Cache-control public;
        }

        location ~* ^.+\.(jpg|jpeg|gif)$ {
          expires +24h;
          add_header Cache-Control +24h;
          add_header Cache-control public;
        }

        # error_page 404 /404.html;
        # redirect server error pages to the static page /50x.html
        #
        # error_page 500 502 503 504  /50x.html;
        # location = /50x.html {
        #   root html;
        # }

        if (-f $document_root/system/maintenance.html) {
            rewrite ^(.*)$ /system/maintenance.html last;
            break;
        }
    }


    server {
        listen 80;
        server_name staging.positivelyfrisky.com;
        root /home/mrcap/friskyfactory/staging/current/public;
        access_log logs/friskyfactory.staging.access.log main;
        client_max_body_size 10m;
        # expires 24h;
        passenger_enabled on;
        rails_env staging;
    }


    server {
        listen 80;
        server_name staging.friskysoldiers.com;
        root /home/mrcap/friskyfactory/staging/current/public;
        access_log logs/friskyfactory.staging.access.log main;
        client_max_body_size 10m;
        # expires 24h;
        passenger_enabled on;
        rails_env staging;
    }


    server {
        listen 80;
        server_name staging.dizmdaze.com;
        root /home/mrcap/friskyfactory/staging/current/public;
        access_log logs/friskyfactory.staging.access.log main;
        client_max_body_size 10m;
        # expires 24h;
        passenger_enabled on;
        rails_env staging;
    }


    # HTTPS server
    #
    # server {
    #    listen       443;
    #    server_name  localhost;
    #
    #    ssl                  on;
    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;
    #
    #    ssl_session_timeout  5m;
    #
    #    ssl_protocols  SSLv2 SSLv3 TLSv1;
    #    ssl_ciphers  ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
    #    ssl_prefer_server_ciphers   on;
    #
    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    # }

}
